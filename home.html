<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>主頁 | Home</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@300;500;700&display=swap" rel="stylesheet">

    <style>
        /* --- 1. 全局變量 --- */
        :root {
            --bg-color: #ffffff;
            --text-color: #1a1a1a;
            --accent-color: #000000;
            --secondary-text: #666666;
            
            --skew-angle: -15deg; 
            --content-angle: 15deg; 
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg-color: #000000;
                --text-color: #e5e5e5;
                --accent-color: #ffffff;
                --secondary-text: #888888;
            }
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Noto Serif TC', serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            height: 100vh;
            width: 100vw;
            overflow: hidden; 
            display: flex;
            opacity: 0; 
            animation: pageFadeIn 1s cubic-bezier(0.25, 1, 0.5, 1) forwards;
        }

        @keyframes pageFadeIn {
            0% { opacity: 0; transform: translateY(20px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        /* --- 2. 左側區域 (豎排佈局) --- */
        .left-section {
            width: 30%;
            height: 100%;
            padding: 60px 40px;
            display: flex;
            flex-direction: row; 
            justify-content: center;
            align-items: center;
            z-index: 50; 
            background: transparent;
            gap: 40px; 
            transition: opacity 0.5s ease, transform 0.5s ease; /* 添加過渡 */
        }

        .vertical-text {
            writing-mode: vertical-rl;
            text-orientation: upright;
            letter-spacing: 0.3em;
            user-select: none;
        }

        .my-name {
            font-size: 2.5rem;
            font-weight: 700;
            border-left: 2px solid var(--accent-color); 
            padding-left: 20px;
            display: flex;
            letter-spacing: 0.2em;
            align-items: center; 
            writing-mode: vertical-rl;
        }

        .quote-wrapper {
            height: 60%;
            position: relative;
            cursor: pointer;
            width: 60px; 
        }

        .quote-text {
            font-size: 1.1rem;
            font-weight: 300;
            line-height: 1.5;
            height: 100%;
            position: absolute;
            top: 0;
            right: 0; 
            transition: all 0.6s cubic-bezier(0.25, 0.8, 0.25, 1);
            opacity: 1;
            writing-mode: vertical-rl;
            text-orientation: upright;
        }

        .quote-enter { opacity: 0; transform: translateX(20px); } 
        .quote-active { opacity: 1; transform: translateX(0); }
        .quote-exit { opacity: 0; transform: translateX(-20px); } 


        /* --- 3. 右側幾何區域 --- */
        .right-section {
            width: 70%;
            height: 100%;
            position: relative;
        }

        .geo-viewport {
            position: absolute;
            background: var(--bg-color);
            border: 1.5px solid var(--accent-color);
            transform: skewX(var(--skew-angle)); 
            overflow: hidden;
            transition: transform 0.4s ease, z-index 0s, width 0.8s, height 0.8s, top 0.8s, left 0.8s, border-width 0.3s; 
            /* 增加了 width/height 等屬性的 transition 用於展開動畫 */
            box-shadow: -5px 5px 20px rgba(0,0,0,0.05);
        }

        .geo-viewport.active, .geo-viewport:hover {
            transform: skewX(var(--skew-angle)) scale(1.02);
            box-shadow: -15px 15px 40px rgba(0,0,0,0.15);
            border-color: var(--text-color);
        }

        .geo-scroller {
            width: 120%; 
            height: 100%;
            margin-left: -10%; 
            transform: skewX(var(--content-angle)*2); 
            overflow-y: auto;
            overflow-x: hidden;
            padding: 60px 100px; 
            scrollbar-width: none;
            -ms-overflow-style: none;
            transition: transform 0.8s cubic-bezier(0.65, 0, 0.35, 1), padding 0.8s ease; /* 內容反向旋轉的過渡 */
        }
        .geo-scroller::-webkit-scrollbar { display: none; }

        /* 內容佈局 */
        .box-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 30px;
            display: inline-block; /* 改為 inline-block 以便做效果 */
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 10px;
            cursor: pointer; /* 變為手型，提示可點擊 */
            position: relative;
            transition: color 0.3s;
        }
        
        /* 標題懸停提示效果 */
        .box-title:hover {
            color: var(--secondary-text);
        }
        .box-title::after {
            content: ' ↗'; /* 提示跳轉 */
            font-size: 0.8em;
            opacity: 0;
            transition: opacity 0.3s, transform 0.3s;
            display: inline-block;
            transform: translate(-10px, 10px);
        }
        .box-title:hover::after {
            opacity: 1;
            transform: translate(5px, -5px);
        }

        /* MOMENTS */
        .moment-item {
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 1px dashed rgba(128,128,128,0.3);
        }
        .moment-img {
            width: 100%;
            height: 180px;
            object-fit: cover;
            filter: grayscale(100%);
            transition: filter 0.4s;
            margin-bottom: 15px;
            cursor: pointer;
        }
        .geo-viewport:hover .moment-img { filter: grayscale(0%); }
        
        .moment-text {
            font-size: 0.95rem;
            line-height: 1.8;
            cursor: pointer;
            position: relative;
        }
        @keyframes breathe {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }
        .moment-text:hover {
            animation: breathe 2s infinite ease-in-out;
            color: var(--secondary-text);
        }

        /* ARTICLES */
        .article-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid rgba(128,128,128,0.1);
            cursor: pointer;
            transition: padding 0.3s;
        }
        .article-item:hover { padding-left: 10px; padding-right: 10px; background: rgba(128,128,128,0.05); }
        .article-title { font-size: 1.1rem; font-weight: 500; }
        .article-date { font-size: 0.8rem; font-family: monospace; color: var(--secondary-text); }


        /* --- 定位 --- */
        #moments-box {
            width: 45%;
            height: 50%;
            top: 10%;
            left: 10%;
            z-index: 10; 
        }

        #articles-box {
            width: 55%;
            height: 60%;
            bottom: 5%;
            right: 5%;
            z-index: 9;
        }

        /* --- 4. 關鍵過渡動畫 CSS (新增部分) --- */
        
        /* 當頁面處於跳轉狀態時 */
        body.is-transitioning .left-section {
            opacity: 0;
            transform: translateX(-50px);
            pointer-events: none;
        }
        
        body.is-transitioning .geo-viewport:not(.expanding) {
            opacity: 0;
            transform: scale(0.9);
            pointer-events: none;
            transition: opacity 0.4s ease, transform 0.4s ease;
        }

        /* 正在展開的板塊 */
        .geo-viewport.expanding {
            position: fixed !important; /* 強制固定全屏 */
            top: 0 !important;
            left: 0 !important;
            width: 100vw !important;
            height: 100vh !important;
            transform: skewX(0deg) !important; /* 取消傾斜，變回矩形 */
            z-index: 9999 !important; /* 最上層 */
            border-width: 0 !important;
            background-color: var(--bg-color); /* 確保背景不透明 */
            transition: all 0.8s cubic-bezier(0.7, 0, 0.3, 1) !important; /* 優雅的貝塞爾曲線 */
            box-shadow: none !important;
        }

        /* 展開時，內部的滾動容器也要取消傾斜 */
        .geo-viewport.expanding .geo-scroller {
            transform: skewX(0deg) !important;
            width: 100% !important;
            margin-left: 0 !important;
            padding: 100px 20%; /* 展開後內容居中，兩側留白 */
            max-width: 1200px; /* 限制最大閱讀寬度 */
            margin: 0 auto !important; /* 居中 */
        }

        /* 手機適配簡單處理 */
        @media (max-width: 768px) {
            body { flex-direction: column; overflow: auto; }
            .left-section { width: 100%; height: auto; flex-direction: column; padding: 40px; }
            .right-section { width: 100%; height: 80vh; }
            .my-name, .quote-wrapper { writing-mode: horizontal-tb; height: auto; width: auto; border: none; }
            .geo-viewport { transform: none !important; border: 1px solid var(--accent-color); }
            .geo-scroller { transform: none; width: 100%; margin: 0; padding: 20px; }
            /* 手機版展開邏輯可以簡化，直接跳轉，或者同樣全屏覆蓋 */
            .geo-viewport.expanding .geo-scroller { padding: 80px 20px; }
        }

    </style>
</head>
<body>

    <!-- 左側：豎排名字與格言 -->
    <section class="left-section">
        <div class="my-name">
            Joyance
        </div>
        <div class="quote-wrapper" id="quote-area">
            <div class="quote-text quote-active" id="current-quote"></div>
        </div>
    </section>

    <!-- 右側：幾何板塊 -->
    <section class="right-section">
        
        <!-- 1. MOMENTS 動態板塊 -->
        <div class="geo-viewport" id="moments-box" data-id="moments">
            <div class="geo-scroller">
                <!-- 添加 onclick 觸發展開 -->
                <span class="box-title" onclick="expandSection('moments', event)">MOMENTS</span>
                
                <div class="moment-item">
                    <img src="https://images.unsplash.com/photo-1493663284031-b7e3aefcae8e?auto=format&fit=crop&w=600&q=80" class="moment-img">
                    <p class="moment-text copy-target" onclick="copyText(this)">
                        生活不是等待風暴過去，而是學會在雨中跳舞。（點擊複製我）
                    </p>
                </div>
                
                <div class="moment-item">
                    <img src="https://images.unsplash.com/photo-1519681393784-d120267933ba?auto=format&fit=crop&w=600&q=80" class="moment-img">
                    <p class="moment-text copy-target" onclick="copyText(this)">
                        仰望星空，腳踏實地。
                    </p>
                </div>
                <!-- 更多內容... -->
                <div style="height: 100px;"></div>
            </div>
        </div>

        <!-- 2. ARTICLES 文章板塊 -->
        <div class="geo-viewport" id="articles-box" data-id="articles">
            <div class="geo-scroller">
                <!-- 添加 onclick 觸發展開 -->
                <span class="box-title" onclick="expandSection('articles', event)">ARTICLES</span>
                
                <div class="article-item" onclick="openLink('post-1')">
                    <span class="article-title">幾何美學的構建</span>
                    <span class="article-date">2023.11.02</span>
                </div>
                <div class="article-item" onclick="openLink('post-2')">
                    <span class="article-title">CSS Skew 的反向邏輯</span>
                    <span class="article-date">2023.10.15</span>
                </div>
                <div class="article-item" onclick="openLink('post-3')">
                    <span class="article-title">垂直排版的藝術</span>
                    <span class="article-date">2023.09.28</span>
                </div>
                <div style="height: 100px;"></div>
            </div>
        </div>

    </section>

    <script>
        // --- 1. 格言系統 ---
        const quotes = [
            "困在蹉跎 空轉 不如漂浮在迷茫的美夢裡",
            "我不想安慰你 在顫抖的楓葉上 寫滿春天的謊言",
            "風起的時候，我們一起回家",
            "沈默是另一種大聲的喧嘩"
        ];
        
        let quoteIndex = 0;
        const quoteEl = document.getElementById('current-quote');
        const quoteArea = document.getElementById('quote-area');
        
        quoteEl.innerText = quotes[0];

        function updateQuote(direction) {
            quoteEl.classList.remove('quote-active');
            quoteEl.classList.add(direction === 'next' ? 'quote-exit' : 'quote-enter');
            
            setTimeout(() => {
                if (direction === 'next') {
                    quoteIndex = (quoteIndex + 1) % quotes.length;
                } else {
                    quoteIndex = (quoteIndex - 1 + quotes.length) % quotes.length;
                }
                quoteEl.innerText = quotes[quoteIndex];
                quoteEl.classList.remove('quote-exit', 'quote-enter');
                void quoteEl.offsetWidth;
                quoteEl.classList.add('quote-active');
            }, 300);
        }

        quoteArea.addEventListener('click', () => updateQuote('next'));

        let isScrolling = false;
        quoteArea.addEventListener('wheel', (e) => {
            if (isScrolling) return;
            if (Math.abs(e.deltaY) > 20 || Math.abs(e.deltaX) > 20) {
                isScrolling = true;
                const dir = (e.deltaY > 0 || e.deltaX > 0) ? 'next' : 'prev';
                updateQuote(dir);
                setTimeout(() => isScrolling = false, 800);
            }
        });

        // --- 2. 複製功能 ---
        async function copyText(el) {
            const text = el.innerText.replace('（點擊複製我）', '').trim();
            try {
                await navigator.clipboard.writeText(text);
                const originalColor = el.style.color;
                el.style.color = '#ccc'; 
                el.style.transition = 'color 0.2s';
                setTimeout(() => el.style.color = originalColor, 200);
            } catch (err) {
                console.error('Copy failed', err);
            }
        }

        // --- 3. 板塊層級管理 ---
        const momentsBox = document.getElementById('moments-box');
        const articlesBox = document.getElementById('articles-box');
        const boxes = [momentsBox, articlesBox];
        const STORAGE_KEY = 'blog_active_box';

        function bringToFront(activeId) {
            // 如果正在動畫中，禁止切換層級，避免閃爍
            if (document.body.classList.contains('is-transitioning')) return;

            boxes.forEach(box => {
                if (box.id === activeId) {
                    box.style.zIndex = 20; 
                    box.classList.add('active');
                } else {
                    box.style.zIndex = 10; 
                    box.classList.remove('active');
                }
            });
            localStorage.setItem(STORAGE_KEY, activeId);
        }

        boxes.forEach(box => {
            box.addEventListener('mouseenter', () => bringToFront(box.id));
            box.addEventListener('click', () => bringToFront(box.id));
        });

        const savedId = localStorage.getItem(STORAGE_KEY);
        if (savedId) bringToFront(savedId);
        else bringToFront('moments-box');


        // --- 4. 展開跳轉邏輯 (新增) ---
        // 點擊 Title 觸發
        function expandSection(type, event) {
            // 阻止冒泡，避免觸發 z-index 切換（雖然不影響，但保險）
            if(event) event.stopPropagation();

            const box = document.getElementById(type + '-box');
            
            // 1. 設置 body 狀態：隱藏左邊欄和另一個板塊
            document.body.classList.add('is-transitioning');
            
            // 2. 讓被點擊的板塊執行展開動畫
            // 這裡必須確保它的 z-index 最高
            box.style.zIndex = 9999;
            box.classList.add('expanding');

            // 3. 800ms 動畫結束後跳轉到對應頁面
            setTimeout(() => {
                // 假設完整頁面文件名為 moments.html 和 articles.html
                window.location.href = './' + type + '.html';
            }, 800);
        }

        function openLink(slug) {
            // 這裡可以做文章具體跳轉邏輯
            console.log("Opening post:", slug);
            // window.location.href = slug + '.html';
        }

    </script>
</body>
</html>
